<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TynderlyQ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f3f3f3;
            overflow: hidden;
            touch-action: none; /* Critical for drag gestures */
        }

        /* Tinder-like Gradient Text */
        .text-gradient {
            background: -webkit-linear-gradient(45deg, #fd267a, #ff6036);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* The Main Card Stack */
        #card-stack {
            perspective: 1000px;
        }

        .tinder-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 1rem;
            background-color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            will-change: transform, opacity;
            overflow: hidden;
            cursor: grab;
            user-select: none;
            /* Default transform origin for rotation */
            transform-origin: 50% 100%;
        }

        .tinder-card:active {
            cursor: grabbing;
        }

        /* Overlay Stamps (LIKE / NOPE / SUPER LIKE) */
        .stamp {
            position: absolute;
            padding: 5px 10px;
            border: 4px solid;
            border-radius: 8px;
            font-size: 32px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0;
            z-index: 10;
        }

        .stamp-like {
            top: 40px;
            left: 40px;
            color: #4ccc93;
            border-color: #4ccc93;
            transform: rotate(-15deg);
        }

        .stamp-nope {
            top: 40px;
            right: 40px;
            color: #ec5e6f;
            border-color: #ec5e6f;
            transform: rotate(15deg);
        }

        .stamp-super {
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) rotate(0deg);
            color: #3b82f6;
            border-color: #3b82f6;
            font-size: 24px;
            white-space: nowrap;
        }

        /* Gradient overlay for text readability */
        .card-gradient {
            background: linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.8) 100%);
        }

        /* Button Pulse Effect */
        .btn-shadow {
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }
        .btn-shadow:active {
            transform: scale(0.9);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Hide scrollbar */
        ::-webkit-scrollbar {
            display: none;
        }

        /* Loader */
        #loader {
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 0.8; }
            100% { transform: scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body class="flex flex-col h-screen w-screen items-center justify-center">

    <!-- Mobile Device Container -->
    <div class="relative w-full h-full md:w-[375px] md:h-[750px] bg-white md:rounded-3xl md:shadow-2xl overflow-hidden flex flex-col">
        
        <!-- Header -->
        <header class="h-14 w-full flex items-center justify-between px-4 z-20 bg-white bg-opacity-90 backdrop-blur-sm border-b border-gray-100">
            <button class="text-gray-400 hover:text-[#fd267a] transition-colors">
                <i class="fas fa-user text-xl"></i>
            </button>
            
            <div class="flex items-center gap-1 cursor-pointer" onclick="location.reload()">
                <i class="fas fa-fire text-2xl" style="color: #fd267a;"></i>
                <h1 class="text-2xl font-bold tracking-tight text-gradient">tynderlyQ</h1>
            </div>

            <button class="text-gray-400 hover:text-[#fd267a] transition-colors">
                <i class="fas fa-comments text-xl"></i>
            </button>
        </header>

        <!-- Main Card Area -->
        <main class="flex-1 relative w-full p-2 overflow-hidden flex flex-col items-center justify-center bg-gray-50">
            
            <!-- Empty State / Background -->
            <div class="absolute inset-0 flex flex-col items-center justify-center z-0">
                <div class="relative w-24 h-24 rounded-full bg-white shadow-sm flex items-center justify-center mb-4">
                    <img id="loader" src="https://www.svgrepo.com/show/521639/user-circle.svg" class="w-24 h-24 opacity-20 rounded-full" alt="Loading">
                </div>
                <p class="text-gray-400 text-sm font-medium">No more profiles nearby.</p>
                <button onclick="resetStack()" class="mt-6 px-8 py-3 bg-white text-[#fd267a] border border-[#fd267a] rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm transition-all">
                    Start Over
                </button>
            </div>

            <!-- The Stack -->
            <div id="card-stack" class="relative w-full h-full max-h-[600px] max-w-[360px]">
                <!-- Cards injected via JS -->
            </div>
        </main>

        <!-- Controls -->
        <footer class="h-28 w-full flex items-center justify-evenly px-4 pb-6 z-20 bg-gradient-to-t from-white via-white to-transparent pt-4">
            <!-- Rewind (Back) -->
            <button id="btn-rewind" class="btn-shadow w-12 h-12 rounded-full bg-white border border-yellow-400 flex items-center justify-center text-yellow-400 hover:bg-yellow-50 transition-colors">
                <i class="fas fa-undo text-lg"></i>
            </button>
            
            <!-- Nope (Left) -->
            <button id="btn-nope" class="btn-shadow w-16 h-16 rounded-full bg-white border border-[#ec5e6f] flex items-center justify-center text-[#ec5e6f] hover:bg-red-50 transition-colors">
                <i class="fas fa-times text-3xl"></i>
            </button>

            <!-- Super Like (Star) -->
            <button id="btn-superlike" class="btn-shadow w-12 h-12 rounded-full bg-white border border-blue-400 flex items-center justify-center text-blue-400 hover:bg-blue-50 transition-colors">
                <i class="fas fa-star text-lg"></i>
            </button>

            <!-- Like (Right) -->
            <button id="btn-like" class="btn-shadow w-16 h-16 rounded-full bg-white border border-[#4ccc93] flex items-center justify-center text-[#4ccc93] hover:bg-green-50 transition-colors">
                <i class="fas fa-heart text-3xl"></i>
            </button>

            <!-- Reset (Was Boost) -->
            <button id="btn-reset" class="btn-shadow w-12 h-12 rounded-full bg-white border border-purple-400 flex items-center justify-center text-purple-400 hover:bg-purple-50 transition-colors" title="Reset Stack">
                <i class="fas fa-redo text-lg"></i>
            </button>
        </footer>
    </div>

    <script>
        // --- Data ---
        // Using local paths as requested, with robust fallbacks
        const initialProfiles = [
            {
                id: 1,
                name: 'Sarah',
                age: 24,
                bio: 'Coffee addict ‚òï | Travel enthusiast ‚úàÔ∏è | Dog mom üêï',
                img: '/img/photo1.jpeg',
                fallback: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 2,
                name: 'Jessica',
                age: 22,
                bio: 'Looking for someone to go on adventures with. üèîÔ∏è',
                img: '/img/photo2.jpeg',
                fallback: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 3,
                name: 'Emily',
                age: 26,
                bio: 'Artist. Foodie. Let\'s get tacos. üåÆ',
                img: '/img/photo3.jpg',
                fallback: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 4,
                name: 'Chloe',
                age: 23,
                bio: 'Just moved to the city! Show me around? üèôÔ∏è',
                img: '/img/photo4.jpg',
                fallback: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-1.2.1&auto=format&fit=crop&w=764&q=80'
            },
            {
                id: 5,
                name: 'Ashley',
                age: 25,
                bio: 'Swipe right if you like bad puns. üòâ',
                img: '/img/photo5.jpg',
                fallback: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 6,
                name: 'Ashley',
                age: 25,
                bio: 'Swipe right if you like bad puns. üòâ',
                img: '/img/photo5.jpg',
                fallback: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 7,
                name: 'Ashley',
                age: 25,
                bio: 'Swipe right if you like bad puns. üòâ',
                img: '/img/photo5.jpg',
                fallback: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 8,
                name: 'Ashley',
                age: 25,
                bio: 'Swipe right if you like bad puns. üòâ',
                img: '/img/photo5.jpg',
                fallback: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            },
            {
                id: 9,
                name: 'Ashley',
                age: 25,
                bio: 'Swipe right if you like bad puns. üòâ',
                img: '/img/photo5.jpg',
                fallback: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=687&q=80'
            }
        ];

        // --- State Management ---
        let activeProfiles = [...initialProfiles]; 
        let historyStack = []; // Stores deleted cards for Undo
        const stackContainer = document.getElementById('card-stack');

        // --- Core Functions ---

        function createCardElement(profile) {
            const card = document.createElement('div');
            card.classList.add('tinder-card');
            
            card.innerHTML = `
                <img src="${profile.img}" 
                     onerror="this.src='${profile.fallback}'" 
                     class="absolute inset-0 w-full h-full object-cover pointer-events-none select-none" 
                     draggable="false"
                     alt="${profile.name}">
                
                <div class="stamp stamp-like">LIKE</div>
                <div class="stamp stamp-nope">NOPE</div>
                <div class="stamp stamp-super">SUPER LIKE</div>

                <div class="absolute bottom-0 w-full p-4 text-white card-gradient pointer-events-none select-none">
                    <h2 class="text-3xl font-bold drop-shadow-md">
                        ${profile.name} <span class="text-2xl font-normal ml-2">${profile.age}</span>
                    </h2>
                    <p class="mt-1 text-sm font-medium opacity-90 drop-shadow-sm line-clamp-2">
                        <i class="fas fa-quote-left text-xs mr-1 opacity-70"></i> 
                        ${profile.bio}
                    </p>
                </div>
            `;
            // Attach data for retrieval later
            card.profileData = profile;
            return card;
        }

        function initCards() {
            stackContainer.innerHTML = '';
            historyStack = [];
            activeProfiles = [...initialProfiles];
            
            // Render in reverse order so the first array item is on TOP of the DOM
            // Actually, `appendChild` adds to the bottom. So the last added is visually on top.
            // We want index 0 to be on top.
            // Let's modify the Z-Index strategy or just reverse the loop.
            // Simplest: Render all. Last one in DOM is top. 
            // So we need to reverse the array before rendering to make index 0 the last child?
            // No, let's keep array order: Index 0 is the current card.
            // We will reverse loop to append Index 4, then 3, then 2... so Index 0 is last child (Top).
            
            [...activeProfiles].reverse().forEach(profile => {
                const card = createCardElement(profile);
                stackContainer.appendChild(card);
            });

            applyInteractions();
        }

        function getTopCard() {
            // In this setup, the last child is the top card visually
            return stackContainer.lastElementChild;
        }

        // --- Interactions (Drag & Swipe) ---

        function applyInteractions() {
            const topCard = getTopCard();
            if (!topCard || topCard.classList.contains('swiping')) return;

            // Variables
            let isDragging = false;
            let startX = 0;
            let startY = 0;
            let currentX = 0;
            let currentY = 0;
            let rotateValue = 0;

            const likeStamp = topCard.querySelector('.stamp-like');
            const nopeStamp = topCard.querySelector('.stamp-nope');
            const superStamp = topCard.querySelector('.stamp-super');

            const onStart = (e) => {
                isDragging = true;
                // Normalize Touch/Mouse
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                startY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
                
                // Remove transition for instant follow
                topCard.style.transition = 'none';
            };

            const onMove = (e) => {
                if (!isDragging) return;
                
                // If touch, prevent scrolling
                if(e.type.includes('touch')) e.preventDefault();

                const clientX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const clientY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;

                currentX = clientX - startX;
                currentY = clientY - startY;

                // Rotate based on X movement
                rotateValue = currentX * 0.05;

                // Move the card
                topCard.style.transform = `translateX(${currentX}px) translateY(${currentY}px) rotate(${rotateValue}deg)`;

                // --- Stamp Logic ---
                // Reset opacities first
                likeStamp.style.opacity = 0;
                nopeStamp.style.opacity = 0;
                superStamp.style.opacity = 0;

                const threshold = 20;

                if (currentY < -50 && Math.abs(currentX) < 50) {
                    // Pulling up for Super Like
                    const opacity = Math.min(Math.abs(currentY) / 100, 1);
                    superStamp.style.opacity = opacity;
                } else if (currentX > threshold) {
                    // Right
                    const opacity = Math.min(Math.abs(currentX) / 100, 1);
                    likeStamp.style.opacity = opacity;
                } else if (currentX < -threshold) {
                    // Left
                    const opacity = Math.min(Math.abs(currentX) / 100, 1);
                    nopeStamp.style.opacity = opacity;
                }
            };

            const onEnd = () => {
                isDragging = false;
                // Slower, smoother release animation as requested
                topCard.style.transition = 'transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1)';

                const xThreshold = 100;
                const yThreshold = -100;

                if (currentY < yThreshold && Math.abs(currentX) < 100) {
                    // Super Like (Up)
                    performSwipe(topCard, 'up');
                } else if (currentX > xThreshold) {
                    // Like (Right)
                    performSwipe(topCard, 'right');
                } else if (currentX < -xThreshold) {
                    // Nope (Left)
                    performSwipe(topCard, 'left');
                } else {
                    // Reset to center
                    topCard.style.transform = `translate(0px, 0px) rotate(0deg)`;
                    likeStamp.style.opacity = 0;
                    nopeStamp.style.opacity = 0;
                    superStamp.style.opacity = 0;
                }
            };

            // Attach listeners
            topCard.addEventListener('mousedown', onStart);
            topCard.addEventListener('touchstart', onStart, { passive: false });

            document.addEventListener('mousemove', onMove);
            document.addEventListener('touchmove', onMove, { passive: false });

            document.addEventListener('mouseup', onEnd);
            document.addEventListener('touchend', onEnd);

            // Save cleanup closure on the element to remove listeners later
            topCard.cleanup = () => {
                topCard.removeEventListener('mousedown', onStart);
                topCard.removeEventListener('touchstart', onStart);
                document.removeEventListener('mousemove', onMove);
                document.removeEventListener('touchmove', onMove);
                document.removeEventListener('mouseup', onEnd);
                document.removeEventListener('touchend', onEnd);
            };
        }

        function performSwipe(card, direction) {
            // Mark as processing
            card.classList.add('swiping');
            
            let transformString = '';
            
            if (direction === 'right') {
                transformString = `translateX(${window.innerWidth + 200}px) rotate(30deg)`;
                card.querySelector('.stamp-like').style.opacity = 1;
            } else if (direction === 'left') {
                transformString = `translateX(-${window.innerWidth + 200}px) rotate(-30deg)`;
                card.querySelector('.stamp-nope').style.opacity = 1;
            } else if (direction === 'up') {
                transformString = `translateY(-${window.innerHeight + 200}px) rotate(0deg)`;
                card.querySelector('.stamp-super').style.opacity = 1;
                // Add blue glow for Super Like
                card.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.6)';
            }

            card.style.transform = transformString;

            // Remove after animation
            setTimeout(() => {
                removeCard(card);
            }, 600); // Wait for transition
        }

        function removeCard(card, saveToHistory = true) {
            if (card.cleanup) card.cleanup();
            
            if (saveToHistory) {
                historyStack.push(card.profileData);
            }
            
            card.remove();
            
            // Setup next card
            setTimeout(() => {
                applyInteractions();
            }, 50);
        }

        // --- Button Logic ---

        function handleButtonSwipe(direction) {
            const topCard = getTopCard();
            if (!topCard) return;

            // Add transition for button click
            topCard.style.transition = 'transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1)';
            performSwipe(topCard, direction);
        }

        function undoSwipe() {
            if (historyStack.length === 0) {
                // Shake the button to indicate empty
                const btn = document.getElementById('btn-rewind');
                btn.style.transform = 'translateX(-5px)';
                setTimeout(() => btn.style.transform = 'translateX(5px)', 50);
                setTimeout(() => btn.style.transform = 'none', 100);
                return;
            }

            const lastProfile = historyStack.pop();
            const card = createCardElement(lastProfile);
            
            // Set initial state for animation (fly in from left/scale up)
            card.style.transform = 'scale(0.8) translateX(-100px)';
            card.style.opacity = '0';
            card.style.transition = 'transform 0.4s ease-out, opacity 0.4s ease';

            stackContainer.appendChild(card);

            // Trigger animation next frame
            requestAnimationFrame(() => {
                card.style.transform = 'scale(1) translateX(0)';
                card.style.opacity = '1';
            });

            // Re-apply interactions
            setTimeout(() => {
                // Remove the transition so drag works instantly later
                card.style.transition = 'none';
                applyInteractions();
            }, 400);
        }

        function resetStack() {
            // Add rotation animation to the reset button
            const btn = document.getElementById('btn-reset');
            const icon = btn.querySelector('i');
            icon.style.transition = 'transform 0.5s ease';
            icon.style.transform = 'rotate(360deg)';
            
            setTimeout(() => {
                icon.style.transform = 'rotate(0deg)';
            }, 500);

            initCards();
        }

        // --- Event Listeners ---

        document.getElementById('btn-like').addEventListener('click', () => handleButtonSwipe('right'));
        document.getElementById('btn-nope').addEventListener('click', () => handleButtonSwipe('left'));
        document.getElementById('btn-superlike').addEventListener('click', () => handleButtonSwipe('up'));
        document.getElementById('btn-rewind').addEventListener('click', undoSwipe);
        document.getElementById('btn-reset').addEventListener('click', resetStack);

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') handleButtonSwipe('left');
            if (e.key === 'ArrowRight') handleButtonSwipe('right');
            if (e.key === 'ArrowUp') handleButtonSwipe('up');
            if (e.key === 'Backspace') undoSwipe();
        });

        // Start
        initCards();

    </script>
</body>
</html>